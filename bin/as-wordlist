#! /bin/bash

WORDLIST_TYPE="$1"

if [[ -n "$BASH_VERSION" ]]; then
  pushd `dirname ${BASH_SOURCE[0]}` > /dev/null
else
  pushd `dirname $0` > /dev/null
fi

ARSENIC_PATH=$(dirname `pwd`)
popd > /dev/null

if [ "$WORDLIST_TYPE" == "content-discovery" ]; then
  secListsPath="$(arsenic config -g secListsPath)"

  if [ ! -d "$secListsPath" ]; then
    echo "Not a dir $secListsPath"
    exit 255
  fi

  content_discovery_file="var/seclist-content-discovery-files.txt"
  {
    if [ -f "as/$content_discovery_file" ]; then
      cat "as/$content_discovery_file"
    else
      cat "$ARSENIC_PATH/$content_discovery_file"
    fi
  } | sort -u | while read path; do
    cat "$secListsPath/$path"
  done\
  | sed 's|^/*||g' \
  | grep -vP "\.(gif|ico|jpe?g|png|js|css)" \
  | sort -h \
  | uniq
fi

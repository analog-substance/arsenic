#! /bin/bash

SCOPE_FILE="scope-domains.txt"

if [ ! -z $1 ]; then
  if [ -f $1 ]; then
    SCOPE_FILE="$1"
  fi
fi

if [ ! -f $SCOPE_FILE ]; then
  echo "`basename $0` scope_file"
  exit;
fi

echo "[+] Ensuring recon directory exists üïµÔ∏è"

mkdir -p recon/domains

echo "[+] finding subdomains from crtsh using $SCOPE_FILE"
cat "$SCOPE_FILE" | while read domain; do 
	ar-crtsh-slrp $domain | tee recon/domains/$domain.crtsh.txt

	whois $domain | tee recon/domains/$domain.whois.txt
	host -A $domain | tee recon/domains/$domain.host.txt
	dig $domain TXT | tee recon/domains/$domain.dig-TXT.txt
	dig $domain NS | tee recon/domains/$domain.dig-NS.txt
	dig $domain MX | tee recon/domains/$domain.dig-MX.txt
	dig $domain SOA | tee recon/domains/$domain.dig-SOA.txt
	dig $domain A | tee recon/domains/$domain.dig-A.txt
done

